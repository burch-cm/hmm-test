}
}
fizzbuzz2()
1:15 %% 15
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch((i %% 15),
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
}
}
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch((i %% 15),
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
}
}
switch(i %% 15),
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch(i %% 15,
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
}
}
switch((i %% 15),
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch({1 %% 15},
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
}
}
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch({i %% 15},
3 = print("fizz"),
5 = print("buzz"),
0 = print("fizzbuzz"),
print(i))
}
}
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
}
}
switch(i %% 15)
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch(i %% 15)
}
}
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch(i %% 15,
0 = print("fizzbuzz"),
print(i))
}
}
switch(i %% 15,
0 = print("fizzbuzz"))
fizzbuzz2()
fizzbuzz2 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
switch(character(i %% 15),
"0" = print("fizzbuzz"),
"3" = print("fizz"),
"5" = print("buzz"),
print(i))
}
}
fizzbuzz2()
# fizzbuzz
fizzbuzz1 <- function(n = 100) {
if (n <= 1) stop("n must be greater than one")
for (i in 1:n) {
if (i %% 15 == 0) { print("fizzbuzz") }
else if (i %% 3 == 0) { print("fizz") }
else if (i %% 5 == 0) { print("buzz") }
else { print(i) }
}
}
fizzbuzz(-2)
fizzbuzz1(-2)
fizzbuzz1("shoe")
typeof(12)
typeof(100)
class(100)
typeof(12L)
n = 8
seq_along(n)
seq_along(1:n)
seq(n)
?seq_along
fizzbuzz2 <- function(n = 100) {
if (class(n) != "numeric") stop("n must be numeric")
if (n <= 1) stop("n must be greater than one")
for (i in seq(n)) {
if (i %% 15 == 0) { print("fizzbuzz") }
else if (i %% 3 == 0) { print("fizz") }
else if (i %% 5 == 0) { print("buzz") }
else { print(i) }
}
}
fizbuzz2(30)
fizzbuzz2 <- function(n = 100) {
if (class(n) != "numeric") stop("n must be numeric")
if (n <= 1) stop("n must be greater than one")
for (i in seq(n)) {
if (i %% 15 == 0) { print("fizzbuzz") }
else if (i %% 3 == 0) { print("fizz") }
else if (i %% 5 == 0) { print("buzz") }
else { print(i) }
}
}
fizbuzz2(30)
fizzbuzz2 <- function(n = 100) {
if (class(n) != "numeric") stop("n must be numeric")
if (n <= 1) stop("n must be greater than one")
for (i in seq(n)) {
if (i %% 15 == 0) { print("fizzbuzz") }
else if (i %% 3 == 0) { print("fizz") }
else if (i %% 5 == 0) { print("buzz") }
else { print(i) }
}
}
fizzbuzz2(30)
vecswitch <- function(x) {
out <- switch(x,
"a" = "a.out",
"b" = "b.out",
"default.out")
return(out)
}
library(purrr)
testvec <- c("a", "a", "b", "c")
map_chr(testvec, vecswitch)
multswitch <- function(x, y, z) {
out_text <- switch(x,
"a" = "a.out",
"b" = "b.out",
"default.out")
out <- paste(y, z, out_test, sep = "/")
return(out)
}
x.vec = testvec
y.vec = "1", "2", "3", "4"
z.vec = "apple", "pear", "beach_ball", "rogue"
y.vec = c("1", "2", "3", "4")
z.vec = c("apple", "pear", "beach_ball", "rogue")
pmap(list(x.vec, y.vec, z.vec), multswitch)
multswitch <- function(x, y, z) {
out_text <- switch(x,
"a" = "a.out",
"b" = "b.out",
"default.out")
out <- paste(y, z, out_text, sep = "/")
return(out)
}
pmap(list(x.vec, y.vec, z.vec), multswitch)
?pmap
pmap(list(x.vec, y.vec, z.vec), multswitch) %>% unlist()
x_states <- matrix(data = c(0.5, 0.3, 0.2,
0.4, 0.1, 0.5,
0.4, 0.1, 0.5),
byrow = TRUE, nrow = 3)
x_states
?matrix
x_states <- matrix(c(0.6, 0.4,
0.3, 0.7),
dimnames = c("sunny", "rainy"),
byrow = TRUE, nrow = 2)
x_states <- matrix(c(0.6, 0.4,
0.3, 0.7),
dimnames = list("sunny", "rainy"),
byrow = TRUE, nrow = 2)
x_states <- matrix(c(0.6, 0.4,
0.3, 0.7),
dimnames = list(c("sunny", "rainy")),
byrow = TRUE, nrow = 2)
x_states
x_states <- matrix(c(0.6, 0.4,
0.3, 0.7),
dimnames = list(c("sunny", "rainy"), c("sunny", "rainy")),
byrow = TRUE, nrow = 2)
x_states
x_emissions <- matrix(c(0.6, 0.3, 0.4,
0.1, 0.4, 0.5),
dimnames = list(c("sunny", "rainy"),
c("walk", "shop", "clean")),
byrow = TRUE, nrow = 2)
x_emissions
x_emissions <- matrix(c(0.6, 0.3, 0.1,
0.1, 0.4, 0.5),
dimnames = list(c("sunny", "rainy"),
c("walk", "shop", "clean")),
byrow = TRUE, nrow = 2)
#
cond_inversion <- function(pr_x_y, pr_y, pr_x_not_y, pr_not_y) {
a = pr_x_y * pr_y
b = pr_x_not_y * pr_not_y
a / (a + b)
}
?sample
x_states
t(x_states)
weather <- data.frame(
sunny = c(.6, .3),
rainy = c(.4, .7)
)
weather
weather <- data.frame(
sunny = c(.6, .3),
rainy = c(.4, .7),
row.names = c("sunny", "rainy")
)
waither
weather
activities <- data.frame(
walk = c(.6, .1),
shop = c(.3, .4),
clean = c(.4, .5),
row.names = c("sunny", "rainy")
)
activities
activities <- data.frame(
walk = c(.6, .1),
shop = c(.3, .4),
clean = c(.1, .5),
row.names = c("sunny", "rainy")
)
activities
activities[[sunny]]
activities["sunny"]
activities[, "sunny"]
activities$2
activities
t(activities)
t(activities)
t(activities)[[suny]]
t(activities)[[sunny]]
t(activities)[["sunny"]]
t(activities)$sunny
class(t(activities))
activities <- data.frame(
activity = c("walk", "shop", "clean"),
sunny = c(0.6, 0.3, 0.1),
rainy = c(01., 0.4, 0.5)
)
activities
weather <- data.frame(
weather = c("sunny", "rainy"),
sunny = c(.6, .3),
rainy = c(.4, .7)
)
weather
library(dplyr)
sample(weather$weather)
sample(weather$weather, 1)
sample(weather$weather, 1) %>% class
sample(weather$weather, 1) -> a
a
weather[weather$weather == a, ]
weather
weather[weather == a]
weather[weather == a, ]
weather[weather$weather == a, ]
weather[weather$weather == a, ]
weather[weather$weather == a, 2:#]
weather[weather$weather == a, 2:3]
weather[weather$weather == a, 2:3]
weather[weather$weather == a, 2:3] %>% class()
weather[weather$weather == a, 2:3] %>% str()
weather[weather$weather == a, 2:3]
sample(names(weather)[-1])
sample(names(weather)[-1], 1)
sample(names(weather)[-1], 1, probs = weather[weather$weather == a, 2:3])
weather[weather$weather == a, 2:3] -> p_1
p_!
p_1
sample(c("sunny", "rainy"), 1, probs = p_1)
sample(c("sunny", "rainy"), 1, prob = p_1)
weather
weather$weather
# long-run state probs.
iterate_state <- function(weather) {
t_prob <- weather[weather$weather == state, 2:3]
t_states <- weather$weather
state <- sample(t_states, 1, prob = t_prob)
}
iterate_state(weather)
# long-run state probs.
iterate_state <- function(weather, state) {
t_prob <- weather[weather$weather == state, 2:3]
t_states <- weather$weather
state <- sample(t_states, 1, prob = t_prob)
}
iterate_state(weather, "sunny")
# long-run state probs.
iterate_state <- function(weather, state) {
t_prob <- weather[weather$weather == state, 2:3]
t_states <- weather$weather
state <- sample(t_states, 1, prob = t_prob)
return(state)
}
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
iterate_state(weather, "sunny")
seq(10)
1:10
simulate_weather <- function(weather, start_state, n) {
state <- start_state
out   <- vector(mode = "character", length = n+1)
out[1] <- state
for (i in seq(n)) {
state <- iterate_state(weather, state)
out[i+1] <- state
}
return(out)
}
simulate_weather(weather, "sunny", 10)
# long-run state probs.
iterate_state <- function(weather, state) {
t_prob <- weather[weather$weather == state, 2:3]
t_states <- as.character(weather$weather)
state <- sample(t_states, 1, prob = t_prob)
return(state)
}
simulate_weather(weather, "sunny", 10)
simulate_weather <- function(weather, start_state = NA, n) {
if (is.na(start_state)) start_state <- weather$weather[1]
state <- start_state
out   <- vector(mode = "character", length = n+1)
out[1] <- state
for (i in seq(n)) {
state <- iterate_state(weather, state)
out[i+1] <- state
}
return(out)
}
# long-run state probs.
simulate_weather <- function(weather, start_state = NA, n) {
iterate_state <- function(weather, state) {
t_prob <- weather[weather$weather == state, 2:3]
t_states <- as.character(weather$weather)
state <- sample(t_states, 1, prob = t_prob)
return(state)
}
if (is.na(start_state)) start_state <- weather$weather[1]
state <- start_state
out   <- vector(mode = "character", length = n+1)
out[1] <- state
for (i in seq(n)) {
state <- iterate_state(weather, state)
out[i+1] <- state
}
return(out)
}
weather_sunny <- simulate_weather(weather, start_state = "sunny", n = 1000)
table(weather_sunny)
weather_rainy <- simulate_weather(weather, start_state = "rainy", n = 1000)
table(weather_rainy)
weather_sunny <- simulate_weather(weather, start_state = "sunny", n = 10000)
weather_rainy <- simulate_weather(weather, start_state = "rainy", n = 10000)
table(weather_sunny)
table(weather_rainy)
library(tidyverse)
utils::getSrcDirectory()
setwd("~/project/hmm-test/code")
source('~/project/hmm-test/code/weather_simple.R', echo=TRUE)
data.frame(sunny = weather_sunny,
rainy = weather_rainy)
data.frame(sunny = weather_sunny,
rainy = weather_rainy) %>%
count()
weather_sunny %>% table()
weather_sunny %>% table() %>% data.frame()
table(weather_sunny) %>% data.frame()
table(weather_sunny) %>% data.frame() %>% rename("Weather", "freq")
table(weather_sunny) %>% data.frame() %>% rename(c("weather", "freq"))
table(weather_sunny) %>% data.frame()
table(weather_sunny) %>% data.frame() %>%
ggplot(aes(x = weather_sunny, y = Freq)) +
geom_bar(stat = "identity")
table(weather_sunny) %>%
data.frame() %>%
ggplot(aes(x = weather_sunny, y = Freq)) +
geom_bar(stat = "identity")
table(weather_sunny) %>%
data.frame()
table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny)
table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq)
start_sunny <- table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq) %>%
mutate(start = "sunny")
start_rainy <- table(weather_rainy) %>%
data.frame() %>%
rename(weather = weather_rainy,
freq = Freq) %>%
mutate(start = "rainy")
start_sunny
left_join(start_sunny, start_rainy, by = "weather")
rbind(start_sunny, start_rainy)
rbind(start_sunny, start_rainy) %>%
ggplot(aes(x = weather, y = freq, group = start)) +
geom_bar(aes(col = start), position = "dodge")
rbind(start_sunny, start_rainy) %>%
ggplot(aes(x = weather, y = freq, group = start)) +
geom_bar(aes(col = start), stat = "identity", position = "dodge")
rbind(start_sunny, start_rainy) %>%
ggplot(aes(x = weather, y = freq, group = start)) +
geom_bar(aes(fill = start), stat = "identity", position = "dodge")
rbind(start_sunny, start_rainy) %>%
ggplot(aes(x = start, y = freq, group = weather)) +
geom_bar(aes(fill = weather), stat = "identity", position = "dodge")
start_sunny <- table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq)
start_rainy <- table(weather_rainy) %>%
data.frame() %>%
rename(weather = weather_rainy,
freq = Freq)
start_sunny
start_sunny <- table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq) %>%
mutate(prob = freq/10000)
start_rainy <- table(weather_rainy) %>%
data.frame() %>%
rename(weather = weather_rainy,
freq = Freq) %>%
mutate(prob = freq/10000)
start_sunny
start_rainy
n.runs = 100000
weather_sunny <- simulate_weather(weather, start_state = "sunny", n = n.runs)
weather_rainy <- simulate_weather(weather, start_state = "rainy", n = n.runs)
start_sunny <- table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq) %>%
mutate(prob = freq/n.max)
start_rainy <- table(weather_rainy) %>%
data.frame() %>%
rename(weather = weather_rainy,
freq = Freq) %>%
mutate(prob = freq/n.max)
start_sunny <- table(weather_sunny) %>%
data.frame() %>%
rename(weather = weather_sunny,
freq = Freq) %>%
mutate(prob = freq/n.runs)
start_rainy <- table(weather_rainy) %>%
data.frame() %>%
rename(weather = weather_rainy,
freq = Freq) %>%
mutate(prob = freq/n.runs)
start_sunny
start_rainy
57+43
table(weather_sunny)
table(weather_sunny) %>% str
table(weather_sunny)
table(weather_sunny)[1,]
table(weather_sunny)[1,1]
table(weather_sunny)["sunny"]
table(weather_sunny)[1]
table(weather_sunny)[2]
table(weather_sunny)[2] %>% nameS()
table(weather_sunny)[2] %>% names()
